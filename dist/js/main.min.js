function getURLParameter(a){return decodeURIComponent((new RegExp("[?|&]"+a+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}function run_geo(a){$.ajax({type:"GET",url:a,dataType:"xml",success:function(a){$(a).find("ip").each(function(){var a=$(this).find("city").text(),b=$(this).find("region").text();if(a!=b)var c=a+", "+b;else var c=a;$('<input type="hidden" />').attr({name:"location","class":"location",value:c}).appendTo("form")})}})}function stabilize(){$("section:not(.menu)").each(function(a,b){var c=$(this),d=c.offset().top,e=d-$(window).scrollTop();e>-$(window).height()/2&&e<$(window).height()/2&&$("html, body").animate({scrollTop:$(this).offset().top},250)})}function menuColor(){$("section:not(.menu)").each(function(a,b){var c=$(this),d=c.data("block-color"),e=c.offset().top;e-$(window).scrollTop();$(window).scrollTop()>=c.offset().top&&($("body").removeClass("dark-block"),$("body").addClass(d))})}$("img").each(function(){var a=$(this).attr("data-original");"undefined"!=typeof a&&a!==!1&&$(this).attr("src",$(this).data("original"))}),$(document).ready(function(){});var requared=$("input[data-required]"),modal=".modal",form=$("form"),yaCounter,ga;$('input[name="phone"]').mask("+7 (999) 999-99-99"),requared.blur(function(){var a=$(this);""==$(this).val().length&&(a.addClass("input_error"),setTimeout(function(){a.removeClass("input_error")},2e3))}),requared.focus(function(){$(this).removeClass("input_error")}),$.get("http://ipinfo.io",function(a){geo_url="http://ipgeobase.ru:7020/geo?ip="+a.ip,run_geo(geo_url)},"jsonp"),utm=[],$.each(["utm_source","utm_medium","utm_campaign","utm_term","source_type","source","position_type","position","added","creative","matchtype"],function(a,b){$('<input type="hidden" />').attr({name:b,"class":b,value:function(){return void 0==getURLParameter(b)?"-":getURLParameter(b)}}).appendTo("form")}),$('<input type="hidden" />').attr({name:"url",value:document.location.href}).appendTo("form"),$('<input type="hidden" />').attr({name:"title",value:document.title}).appendTo("form");var close=function(){$(modal).addClass("hidden"),$(modal+">div:not(.layout)").addClass("hidden"),$("body").removeClass("menu-active")},open=function(){$(modal).removeClass("hidden"),$($(this).data("modal")).removeClass("hidden")},submit_track_event=function(a){yaCounter&&yaCounter.reachGoal(a),ga&&ga("send","event","submit",a)};form.submit(function(a){a.preventDefault();for(var b=$(this),c=!0,d=b.find("[data-required]"),e=0;e<d.length;e++)""==d.eq(e).val()&&(c=!1);if(c){var f=b.attr("method"),g=b.attr("action"),h=b.serialize(),i=b.find('input[name="event"]').val();$.ajax({type:f,url:g,data:h,success:function(){submit_track_event(i),$("#success-pop").arcticmodal(),b.find('input[type="text"]').val(""),$(".step").addClass("hidden"),$('[data-step="0"]').removeClass("hidden"),setTimeout(function(){$.arcticmodal("close")},2e3)}})}else{$("#error-pop").arcticmodal();for(var e=0;e<d.length;e++)""==d.eq(e).val()&&(d.eq(e).addClass("input_error"),setTimeout(function(){d.removeClass("input_error")},2e3))}}),$('[data-btn-type="close"]').on("click",close),$("[data-modal]").on("click",open),$("[data-toggle]").on("click",function(){var a=$(this).data("toggle");$(this).toggleClass(a)}),$("[data-body-class]").on("click",function(){var a=$(this).data("body-class");$("body").toggleClass(a)}),$(window).scroll(function(){$(window).outerWidth()>319&&menuColor(),!isMobile&&$(window).outerWidth()>980&&$(window).outerHeight()>600&&(clearTimeout($.data(this,"scrollTimer")),$.data(this,"scrollTimer",setTimeout(stabilize,1500)))}),$(".play").on("click",function(a){a.preventDefault();var b=$(this).attr("href"),c='<iframe width="100%" height="100%" src="https://www.youtube.com/embed/'+b+'?autoplay=1" frameborder="0"  allowfullscreen></iframe>',d=$(this).parent().find(".video-container");d.addClass("active"),d.html(c)});var construct=function(){var a=!1,b=function(){$(".step").addClass("hidden"),d++,$('[data-step="'+d+'"]').removeClass("hidden")},c=function(){$(".step").addClass("hidden"),d--,$('[data-step="'+d+'"]').removeClass("hidden")},d=0,e=[];$("[data-step-item]").on("click",function(){a=!0,$("[data-step-item]").removeClass("active"),$(this).addClass("active"),e[d]=$(this).data("step-item"),$('.step [name="result"]').val(e),b()}),$(".step .btn-prev").on("click",c)};construct();var prevBtnTpl='<button class="slick-prev"><img src="img/prev.png"><img src="img/prev-hover.png"></button>',nextBtnTpl='<button class="slick-next"><img src="img/next.png"><img src="img/next-hover.png"></button>';$(".s4-slider").slick({prevArrow:prevBtnTpl,nextArrow:nextBtnTpl,responsive:[{breakpoint:960,settings:{arrows:!1,dots:!0}}]}),$(".s4-slider").on("beforeChange",function(a,b,c,d){$(".video-container").removeClass("active").html("")}),setTimeout(function(){$(".s5-slider").slick({slidesToShow:3,prevArrow:prevBtnTpl,nextArrow:nextBtnTpl,focusOnSelect:!0,responsive:[{breakpoint:980,settings:{arrows:!1,dots:!0,slidesToShow:1}}]}),$(".s5-slider").on("beforeChange",function(a,b,c,d){$(".video-container").removeClass("active").html("")})},100),$("[data-bg-pic]").each(function(){var a=$(this).data("bg-pic");$(this).css({backgroundImage:"url("+a+")"})});var picCounter=1;setInterval(function(){picCounter>$(".s3 .pic").length/2&&(picCounter=1),$(".s3 .pic-wrap .pic").removeClass("active"),$(".s3 .pic-wrap .pic:nth-of-type("+picCounter+")").addClass("active"),picCounter++},1500);var navList=$(".menu__list-item a");navList.on("click",function(a){var b=$(this).attr("href");a.preventDefault(),$("body, html").animate({scrollTop:$(b).offset().top},600,close)}),$("[data-scroll]").on("click",function(){var a=$(this).data("scroll");$("body, html").animate({scrollTop:$(a).offset().top},600)});