function getURLParameter(t){return decodeURIComponent((new RegExp("[?|&]"+t+"=([^&;]+?)(&|#|;|$)").exec(location.search)||[,""])[1].replace(/\+/g,"%20"))||null}function run_geo(t){$.ajax({type:"GET",url:t,dataType:"xml",success:function(t){$(t).find("ip").each(function(){var t=$(this).find("city").text(),e=$(this).find("region").text();if(t!=e)var o=t+", "+e;else var o=t;$('<input type="hidden" />').attr({name:"location",class:"location",value:o}).appendTo("form")})}})}function stabilize(){$("section:not(.menu)").each(function(t,e){var o=$(this),a=o.offset().top,n=a-$(window).scrollTop();n>-$(window).height()/2&&n<$(window).height()/2&&$("html, body").animate({scrollTop:$(this).offset().top},250)})}function menuColor(){$("section:not(.menu)").each(function(t,e){var o=$(this),a=o.data("block-color"),n=o.offset().top;n-$(window).scrollTop();$(window).scrollTop()>=o.offset().top&&($("body").removeClass("dark-block"),$("body").addClass(a))})}var requared=$("input[data-required]"),modal=".modal",form=$("form"),yaCounter,ga;$('input[name="phone"]').mask("+7 (999) 999-99-99"),requared.blur(function(){var t=$(this);""==$(this).val().length&&(t.addClass("input_error"),setTimeout(function(){t.removeClass("input_error")},2e3))}),requared.focus(function(){$(this).removeClass("input_error")}),$.get("http://ipinfo.io",function(t){geo_url="http://ipgeobase.ru:7020/geo?ip="+t.ip,run_geo(geo_url)},"jsonp"),utm=[],$.each(["utm_source","utm_medium","utm_campaign","utm_term","source_type","source","position_type","position","added","creative","matchtype"],function(t,e){$('<input type="hidden" />').attr({name:e,class:e,value:function(){return void 0==getURLParameter(e)?"-":getURLParameter(e)}}).appendTo("form")}),$('<input type="hidden" />').attr({name:"url",value:document.location.href}).appendTo("form"),$('<input type="hidden" />').attr({name:"title",value:document.title}).appendTo("form");var close=function(){$(modal).addClass("hidden"),$(modal+">div:not(.layout)").addClass("hidden"),$("body").removeClass("menu-active")},open=function(){$(modal).removeClass("hidden"),$($(this).data("modal")).removeClass("hidden")},submit_track_event=function(t){yaCounter&&yaCounter.reachGoal(t),ga&&ga("send","event","submit",t)};form.submit(function(t){t.preventDefault();for(var e=$(this),o=!0,a=e.find("[data-required]"),n=0;n<a.length;n++)""==a.eq(n).val()&&(o=!1);if(o){var i=e.attr("method"),s=e.attr("action"),r=e.serialize(),c=e.find('input[name="event"]').val();$.ajax({type:i,url:s,data:r,success:function(){submit_track_event(c),$("#success-pop").arcticmodal(),e.find('input[type="text"]').val(""),$(".step").addClass("hidden"),$('[data-step="0"]').removeClass("hidden"),setTimeout(function(){$.arcticmodal("close")},2e3)}})}else{$("#error-pop").arcticmodal();for(var n=0;n<a.length;n++)""==a.eq(n).val()&&(a.eq(n).addClass("input_error"),setTimeout(function(){a.removeClass("input_error")},2e3))}}),$('[data-btn-type="close"]').on("click",close),$("[data-modal]").on("click",open),$("[data-toggle]").on("click",function(){var t=$(this).data("toggle");$(this).toggleClass(t)}),$("[data-body-class]").on("click",function(){var t=$(this).data("body-class");$("body").toggleClass(t)}),$(window).scroll(function(){$(window).outerWidth()>319&&menuColor(),!isMobile&&$(window).outerWidth()>980&&$(window).outerHeight()>600&&(clearTimeout($.data(this,"scrollTimer")),$.data(this,"scrollTimer",setTimeout(stabilize,1500)))}),$(".play").on("click",function(t){t.preventDefault();var e=$(this).attr("href"),o='<iframe width="100%" height="100%" src="https://www.youtube.com/embed/'+e+'?autoplay=1" frameborder="0"  allowfullscreen></iframe>',a=$(this).parent().find(".video-container");a.addClass("active"),a.html(o)});var construct=function(){var t=!1,e=function(){$(".step").addClass("hidden"),a++,$('[data-step="'+a+'"]').removeClass("hidden")},o=function(){$(".step").addClass("hidden"),a--,$('[data-step="'+a+'"]').removeClass("hidden")},a=0,n=[];$("[data-step-item]").on("click",function(){t=!0,$("[data-step-item]").removeClass("active"),$(this).addClass("active"),n[a]=$(this).data("step-item"),$('.step [name="result"]').val(n),e()}),$(".step .btn-prev").on("click",o)};construct();var prevBtnTpl='<button class="slick-prev"><img src="img/prev.png"><img src="img/prev-hover.png"></button>',nextBtnTpl='<button class="slick-next"><img src="img/next.png"><img src="img/next-hover.png"></button>';$(".s4-slider").slick({prevArrow:prevBtnTpl,nextArrow:nextBtnTpl,responsive:[{breakpoint:960,settings:{arrows:!1,dots:!0}}]}),$(".s4-slider").on("beforeChange",function(t,e,o,a){$(".video-container").removeClass("active").html("")}),setTimeout(function(){$(".s5-slider").slick({slidesToShow:3,prevArrow:prevBtnTpl,nextArrow:nextBtnTpl,focusOnSelect:!0,responsive:[{breakpoint:980,settings:{arrows:!1,dots:!0,slidesToShow:1}}]}),$(".s5-slider").on("beforeChange",function(t,e,o,a){$(".video-container").removeClass("active").html("")})},100),$("[data-bg-pic]").each(function(){var t=$(this).data("bg-pic");$(this).css({backgroundImage:"url("+t+")"})});var picCounter=1;setInterval(function(){picCounter>$(".s3 .pic").length/2&&(picCounter=1),$(".s3 .pic-wrap .pic").removeClass("active"),$(".s3 .pic-wrap .pic:nth-of-type("+picCounter+")").addClass("active"),picCounter++},1500);var navList=$(".menu__list-item a");navList.on("click",function(t){var e=$(this).attr("href");t.preventDefault(),$("body, html").animate({scrollTop:$(e).offset().top},600,close)}),$("[data-scroll]").on("click",function(){var t=$(this).data("scroll");$("body, html").animate({scrollTop:$(t).offset().top},600)});